<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>My New Hugo Site  | Nesting is state</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.40.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.ab4b67a3ea25990fa8279f3b7ef08b61.css" rel="stylesheet">
    

    

    
      
    

    

    <meta property="og:title" content="Nesting is state" />
<meta property="og:description" content="There are stylistic debates about how much nesting or indentation one should choose in code. This slide and the one that follows illustrate the issue well. The slide refers to “cognitive load” without explaining, and it occurs to me that nesting is state.
In the first example, if we want to debug around the highlighted line, what do we need to keep in mind? func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) { err = binary." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/blog/nesting-is-state/" />



<meta property="article:published_time" content="2014-03-30T18:05:25&#43;00:00"/>

<meta property="article:modified_time" content="2014-03-30T18:05:25&#43;00:00"/>











<meta itemprop="name" content="Nesting is state">
<meta itemprop="description" content="There are stylistic debates about how much nesting or indentation one should choose in code. This slide and the one that follows illustrate the issue well. The slide refers to “cognitive load” without explaining, and it occurs to me that nesting is state.
In the first example, if we want to debug around the highlighted line, what do we need to keep in mind? func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) { err = binary.">


<meta itemprop="datePublished" content="2014-03-30T18:05:25&#43;00:00" />
<meta itemprop="dateModified" content="2014-03-30T18:05:25&#43;00:00" />
<meta itemprop="wordCount" content="336">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Nesting is state"/>
<meta name="twitter:description" content="There are stylistic debates about how much nesting or indentation one should choose in code. This slide and the one that follows illustrate the issue well. The slide refers to “cognitive load” without explaining, and it occurs to me that nesting is state.
In the first example, if we want to debug around the highlighted line, what do we need to keep in mind? func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) { err = binary."/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="http://example.org/" class="f3 fw2 hover-white no-underline white-90 dib">
      My New Hugo Site
    </a>
    <div class="flex-l items-center">
      
      








    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  <article class="flex-l flex-wrap justify-between mw8 center">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        BLOGS
      </p>
      <h1 class="f1 athelas mb1">Nesting is state</h1>
      
      <time class="f6 mv4 dib tracked" datetime="2014-03-30T18:05:25Z">March 30, 2014</time>
    </header>

    <main class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>There are stylistic debates about how much nesting or indentation one should choose in code. <a href="http://talks.golang.org/2013/bestpractices.slide#3">This slide</a> and the <a href="http://talks.golang.org/2013/bestpractices.slide#4">one that follows</a> illustrate the issue well. The slide refers to “cognitive load” without explaining, and it occurs to me that <strong>nesting is state</strong>.</p>

<p>In the first example, if we want to debug around the highlighted line, what do we need to keep in mind?
<code>func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) {  
    err = binary.Write(w, binary.LittleEndian, int32(len(g.Name)))  
    if err == nil {  
        size += 4  
        var n int  
        n, err = w.Write([]byte(g.Name))  
        size += int64(n)  
        if err == nil {  
            err = binary.Write(w, binary.LittleEndian, int64(g.AgeYears))  
            if err == nil {  
                size += 4  
            }  
            return  
        }  
        return  
    }  
    return  
}</code></p>

<p>Answer: <em>the truth of each of the if statements that precede it.</em> Each of those bits of truth is a piece of state. Now look at the alternative:
<code>func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) {  
    err = binary.Write(w, binary.LittleEndian, int32(len(g.Name)))  
    if err != nil {  
        return  
    }  
    size += 4  
    n, err := w.Write([]byte(g.Name))  
    size += int64(n)  
    if err != nil {  
        return  
    }  
    err = binary.Write(w, binary.LittleEndian, int64(g.AgeYears))  
    if err == nil {  
        size += 4  
    }  
    return  
}</code></p>

<p>In this case, the highlighted line “cares” very little about what came before — all it needs to know is that we got there.</p>

<p>The flattening of the hierarchy plus lots of return-on-fail can be thought of as “shedding” state. I call this pattern “fail fast”: by the time you get to the bottom of the code, you really only need one piece of “state”, which is “we’ve gotten this far successfully”. You can forget the past.</p>

<p>Of course, the logic of these two examples is equivalent. I am speaking of the mental model — the list of “non-local” things that must be kept in mind when working with a local piece of code.</p>

<p>And for me, “list of non-local things” is a good definition of “state”.</p>

<p><a href="https://news.ycombinator.com/item?id=7497134"><em>discuss on hacker news</em></a></p>
<ul class="pa0">
  
</ul>
<div class="mt6">
        
      </div>
    </main>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-near-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://example.org/" >
    &copy; 2018 My New Hugo Site
  </a>
  








  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
