<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Nesting is state" />
<meta property="og:description" content="There are stylistic debates about how much nesting or indentation one should choose in code. This slide and the one that follows illustrate the issue well. The slide refers to “cognitive load” without explaining, and it occurs to me that nesting is state.
In the first example, if we want to debug around the highlighted line, what do we need to keep in mind? func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) { err = binary." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://clipperhouse.netlify.com/blog/nesting-is-state/" />



<meta property="article:published_time" content="2014-03-30T18:05:25&#43;00:00"/>

<meta property="article:modified_time" content="2014-03-30T18:05:25&#43;00:00"/>











<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Nesting is state"/>
<meta name="twitter:description" content="There are stylistic debates about how much nesting or indentation one should choose in code. This slide and the one that follows illustrate the issue well. The slide refers to “cognitive load” without explaining, and it occurs to me that nesting is state.
In the first example, if we want to debug around the highlighted line, what do we need to keep in mind? func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) { err = binary."/>
<meta name="generator" content="Hugo 0.40.3" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Nesting is state",
  "url": "https://clipperhouse.netlify.com/blog/nesting-is-state/",
  "wordCount": "336",
  "datePublished": "2014-03-30T18:05:25&#43;00:00",
  "dateModified": "2014-03-30T18:05:25&#43;00:00",
  "author": {
    "@type": "Person",
    "name": ""
  }
}
</script>



    <link rel="canonical" href="https://clipperhouse.netlify.com/blog/nesting-is-state/">

    <title>Nesting is state | clipperhouse</title>

    <!-- combined, minified CSS -->
    <link href="https://clipperhouse.netlify.com/css/style.css" rel="stylesheet" integrity="sha384-TbfEhJn4HkgPUIZUhhHaAYsycYKHxSuIloCjZOiyCSpbVunRQxg5T5pxKVFwxilF" crossorigin="anonymous">

    

    

    

    

  </head>

  <body>

    
    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="https://clipperhouse.netlify.com/">Home</a>
        </nav>
      </div>
    </div>
    

    
    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title"><a href="https://clipperhouse.netlify.com/" rel="home">clipperhouse</a></h1>
        
      </div>
    </header>
    

    
    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="https://clipperhouse.netlify.com/blog/nesting-is-state/">Nesting is state</a></h2>
    <p class="blog-post-meta"><time datetime="2014-03-30T18:05:25Z">Sun Mar 30, 2014</time> by </p>
  </header>
  <p>There are stylistic debates about how much nesting or indentation one should choose in code. <a href="http://talks.golang.org/2013/bestpractices.slide#3">This slide</a> and the <a href="http://talks.golang.org/2013/bestpractices.slide#4">one that follows</a> illustrate the issue well. The slide refers to “cognitive load” without explaining, and it occurs to me that <strong>nesting is state</strong>.</p>

<p>In the first example, if we want to debug around the highlighted line, what do we need to keep in mind?
<code>func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) {  
    err = binary.Write(w, binary.LittleEndian, int32(len(g.Name)))  
    if err == nil {  
        size += 4  
        var n int  
        n, err = w.Write([]byte(g.Name))  
        size += int64(n)  
        if err == nil {  
            err = binary.Write(w, binary.LittleEndian, int64(g.AgeYears))  
            if err == nil {  
                size += 4  
            }  
            return  
        }  
        return  
    }  
    return  
}</code></p>

<p>Answer: <em>the truth of each of the if statements that precede it.</em> Each of those bits of truth is a piece of state. Now look at the alternative:
<code>func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) {  
    err = binary.Write(w, binary.LittleEndian, int32(len(g.Name)))  
    if err != nil {  
        return  
    }  
    size += 4  
    n, err := w.Write([]byte(g.Name))  
    size += int64(n)  
    if err != nil {  
        return  
    }  
    err = binary.Write(w, binary.LittleEndian, int64(g.AgeYears))  
    if err == nil {  
        size += 4  
    }  
    return  
}</code></p>

<p>In this case, the highlighted line “cares” very little about what came before — all it needs to know is that we got there.</p>

<p>The flattening of the hierarchy plus lots of return-on-fail can be thought of as “shedding” state. I call this pattern “fail fast”: by the time you get to the bottom of the code, you really only need one piece of “state”, which is “we’ve gotten this far successfully”. You can forget the past.</p>

<p>Of course, the logic of these two examples is equivalent. I am speaking of the mental model — the list of “non-local” things that must be kept in mind when working with a local piece of code.</p>

<p>And for me, “list of non-local things” is a good definition of “state”.</p>

<p><a href="https://news.ycombinator.com/item?id=7497134"><em>discuss on hacker news</em></a></p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fclipperhouse.netlify.com%2fblog%2fnesting-is-state%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=https%3a%2f%2fclipperhouse.netlify.com%2fblog%2fnesting-is-state%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fclipperhouse.netlify.com%2fblog%2fnesting-is-state%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=https%3a%2f%2fclipperhouse.netlify.com%2fblog%2fnesting-is-state%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  

  

  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->
    

    
    <footer class="blog-footer">
      <p>
      
      Blog template created by <a href="https://twitter.com/mdo">@mdo</a>, ported to Hugo by <a href='https://twitter.com/mralanorth'>@mralanorth</a>.
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>
    

  </body>

</html>
