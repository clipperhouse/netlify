<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="renderer" content="webkit">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <title>Modal performance in browsers, or, exploiting z-index - clipperhouse</title>
  
  <meta name="description" content="I did a little test. I am using jQuery UI’s dialog, and setting it to be draggable. Pretty standard stuff — after all, dragging windows around your computer is commonplace.
A quick look into task manager and I see that dragging that modal around spikes the CPU to around 50%! (And this is with Chrome, an exceptionally fast browser.) Doing the same with a simple Windows file window pushes the CPU to only 10%.">
  <meta name="author" content="Matt Sherman">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700,700i" rel="stylesheet">
  <link href="https://cdn.bootcss.com/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">
  
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
  <link rel="icon" href="/img/favicon.ico">
  
  <meta name="generator" content="Hugo 0.40.3">
  
  <link rel="alternate" type="application/atom+xml" href="/index.xml" title="clipperhouse">
</head>
<body class="single">
  <header class="header">
    
    <p class="title"><a href="/">clipperhouse</a></p>
    
    <button class="menu-toggle" type="button"></button>
    <nav class="menu">
      <ul>
        
        
      </ul>
    </nav>
  </header>
  <main class="main">

<article class="post post-view">
  <header class="post-header">
  <h1 class="post-title">Modal performance in browsers, or, exploiting z-index</h1>
  <p class="post-meta">Published by Matt Sherman · 2010.1.15</p>
</header>
<div class="post-content"><p>I did a little test. I am using <a href="http://jqueryui.com/demos/dialog/">jQuery UI’s dialog</a>, and setting it to be draggable. Pretty <a href="http://www.scottberkun.com/blog/2010/the-future-of-ui-will-be-boring/">standard stuff</a> — after all, dragging windows around your computer is commonplace.</p>

<p>A quick look into task manager and I see that <strong>dragging that modal around spikes the CPU to around 50%!</strong> (And this is with Chrome, an exceptionally fast browser.) Doing the same with a simple Windows file window pushes the CPU to only 10%. Further, the modal is always a few pixels behind the mouse, which feels sloppy to an end user.</p>

<p>Why does the browser need to work so hard to do the “same” thing? Well, <strong>the browser has no idea what a modal is</strong>. It simply knows that there is a chunk of HTML that is changing position. And so, with each microscopic change, <strong>the browser must recalculate the entire page’s layout</strong>, probably dozens of times per second. As with other jQuery tricks, we are <a href="/blog/post/Hammering-the-DOM.aspx">hammering the DOM</a>.</p>

<p>The goal of Google and other browser makers is to push performance so that Web apps feel like native apps. Of course, we need to keep browsers capable of working with standard HTML/JS/CSS — ignorant of the <em>goals</em> of that code — but certainly there are optimizations to be found.</p>

<p>Here’s one: <strong>a browser should infer when an HTML element is on a z-index that does not affect other parts of the DOM</strong>. It should then know to minimize the reflow redraw when that element moves. This would require many fewer layout calculations and CPU cycles.</p>

<p>Of course, this inference is easier said than done. It would need to look at all the z-indexes of all elements on the page, CSS position attributes, possibly some widths. (The browser maker might document that list of requirements, so that libraries could be optimized against them.) But once the browser makes this determination, the modal should perform at close to native speed.</p>

<p>Maybe it can’t be done. Maybe there is no correct determination of “independence” for one piece of the DOM.</p>

<p>But it would be interesting to find out. Dialogs and windows are such a fundamental part of UI’s and user experience that this would be a modest, yet substantial, step forward for the Web.</p>
</div>
<footer class="post-footer">
    
  </footer>
  
  
  
  
</article>
</main>
<footer class="footer">
  <span>&copy; 2017-2018 clipperhouse</span>
  <span>&middot;</span>
  <span>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a></span>
  <span>&middot;</span>
  <span>Designed by <a href="http://21beats.com/" target="_blank">21beats</a></span>
</footer>
<script src="https://cdn.bootcss.com/instantclick/3.0.1/instantclick.min.js" data-no-instant></script>
<script data-no-instant>InstantClick.init();</script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js" data-no-instant></script>
<script data-no-instant>
  hljs.initHighlightingOnLoad();
  menuToggle();
  InstantClick.on('change', function() {
    var blocks = document.querySelectorAll('pre code');
    for (var i = 0; i < blocks.length; i++) {
      hljs.highlightBlock(blocks[i]);
    }
    menuToggle();
  });
  function menuToggle() {
    var $toggle = document.querySelector('.menu-toggle');
    if (!$toggle.offsetParent) {
      return;
    }
    var $body = document.querySelector('body');
    $toggle.addEventListener('click', function() {
      $body.classList.toggle('noscroll');
    }, false);
  }
</script>
</body>
</html>

