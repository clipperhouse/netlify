<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>My New Hugo Site  | De facto immutability</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.40.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.ab4b67a3ea25990fa8279f3b7ef08b61.css" rel="stylesheet">
    

    

    
      
    

    

    <meta property="og:title" content="De facto immutability" />
<meta property="og:description" content="Another in a series of posts wherein I spitball about things that computer scientists already know, but have only just occurred to me.
Browsing the new Swift docs reveals that immutability is given pretty high billing. There are two keywords for variable declaration/assignment: let and var.
The former declares an immutable value; the latter a mutable one. The former is used much more often in the examples, providing a hint about the intentions of the designers." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/blog/de-facto-immutability/" />



<meta property="article:published_time" content="2014-06-05T23:23:47&#43;00:00"/>

<meta property="article:modified_time" content="2014-06-05T23:23:47&#43;00:00"/>











<meta itemprop="name" content="De facto immutability">
<meta itemprop="description" content="Another in a series of posts wherein I spitball about things that computer scientists already know, but have only just occurred to me.
Browsing the new Swift docs reveals that immutability is given pretty high billing. There are two keywords for variable declaration/assignment: let and var.
The former declares an immutable value; the latter a mutable one. The former is used much more often in the examples, providing a hint about the intentions of the designers.">


<meta itemprop="datePublished" content="2014-06-05T23:23:47&#43;00:00" />
<meta itemprop="dateModified" content="2014-06-05T23:23:47&#43;00:00" />
<meta itemprop="wordCount" content="314">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="De facto immutability"/>
<meta name="twitter:description" content="Another in a series of posts wherein I spitball about things that computer scientists already know, but have only just occurred to me.
Browsing the new Swift docs reveals that immutability is given pretty high billing. There are two keywords for variable declaration/assignment: let and var.
The former declares an immutable value; the latter a mutable one. The former is used much more often in the examples, providing a hint about the intentions of the designers."/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="http://example.org/" class="f3 fw2 hover-white no-underline white-90 dib">
      My New Hugo Site
    </a>
    <div class="flex-l items-center">
      
      








    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  <article class="flex-l flex-wrap justify-between mw8 center">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        BLOGS
      </p>
      <h1 class="f1 athelas mb1">De facto immutability</h1>
      
      <time class="f6 mv4 dib tracked" datetime="2014-06-05T23:23:47Z">June 5, 2014</time>
    </header>

    <main class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p><em>Another in a series of posts wherein I spitball about things that computer scientists already know, but have only just occurred to me.</em></p>

<p>Browsing the new <a href="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/GuidedTour.html#//apple_ref/doc/uid/TP40014097-CH2-XID_1">Swift docs</a> reveals that immutability is given pretty high billing. There are two keywords for variable declaration/assignment: let and var.</p>

<p>The former declares an immutable value; the latter a mutable one. The former is used much more often in the examples, providing a hint about the intentions of the designers.</p>

<p>The first thing I like about this is that the programmer is encouraged to default to immutable. It’s a nudge which suggests, when using var, that perhaps they should think about why they are doing that. It feels exceptional and just a little unsafe. Could this code be rearranged to avoid it?</p>

<p>It also got me thinking about Go, which doesn’t really have a notion of immutability. Well, it does have <a href="http://golang.org/ref/spec#Constants">const</a>, but it’s only for primitives.</p>

<p>Do compilers have a notion of “de facto immutable”? Which is to say, although the programmer has not intended this value to be immutable, the compiler can prove that, in fact, it is not mutated; that there is no path by which the value can change.</p>

<p>This opens up optimization possibilities. One is that values can be <a href="https://groups.google.com/d/msg/golang-nuts/FBkKg3LIKB8/wHW0gGo5J6sJ">inlined</a> in simple situations.</p>

<p>A second, as <a href="https://twitter.com/kevinmontrose/status/474670162390818816">pointed out</a> by Kevin Montrose, is that <a href="http://en.wikipedia.org/wiki/Memory_barrier">ordering of reads and writes</a> can be skipped for de facto immutable values. (Similarly helpful in concurrent situations, of course.)</p>

<p>A third is that anything passed by value, but known not to be mutated, need not result in a copy of the value. Under the hood, a pointer can be passed safely, reducing work as well as memory/GC pressure. This is analogous to <a href="http://en.wikipedia.org/wiki/String_interning">interning strings</a>.</p>

<p>Would be interested to know which languages exploit these ideas, or if there are logical problems with them that I’ve missed.</p>

<p><a href="https://news.ycombinator.com/item?id=7855306"><em>discuss on hacker news</em></a></p>
<ul class="pa0">
  
</ul>
<div class="mt6">
        
      </div>
    </main>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-near-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://example.org/" >
    &copy; 2018 My New Hugo Site
  </a>
  








  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
