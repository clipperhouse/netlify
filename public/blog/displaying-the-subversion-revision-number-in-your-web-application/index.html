<!DOCTYPE html>
<html lang="en-us">
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-8534189-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-8534189-2');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="renderer" content="webkit">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Displaying the Subversion revision number in your web application - clipperhouse</title>
  <meta name="description" content="I found a nice technique for automatically displaying the SVN revision number in the footer of a web site.">
  <meta name="author" content="Matt Sherman">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700,700i" rel="stylesheet">

  <link href="/css/style.css" rel="stylesheet">

  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
  <link rel="icon" href="/img/favicon.ico">

  <meta name="generator" content="Hugo 0.40.3">

  <link rel="alternate" type="application/atom+xml" href="/index.xml" title="clipperhouse">
</head>
<body class="single">
  <header class="header">
    
    <p class="title"><a href="/">clipperhouse</a></p>
    
    <button class="menu-toggle" type="button"></button>
    <nav class="menu">
      <ul>
        
        
      </ul>
    </nav>
  </header>
  <main class="main">

<article class="post post-view">
  <header class="post-header">
  <h1 class="post-title">Displaying the Subversion revision number in your web application</h1>
  <p class="post-meta">Published by Matt Sherman · May 26, 2009</p>
</header>
<div class="post-content"><p>I found a nice technique for automatically displaying the SVN revision number in the footer of a web site. It is based in <a href="http://ccnet.thoughtworks.com/">CruiseControl.Net</a>.</p>

<p>Why would I do this? Well, we don’t have a strict version numbering convention for our app. We roll out incremental builds all the time. This falls under the technique of “continuous integration”, or in Google’s case, “eternal beta”. So it’s easier just to have the app give itself an incremental version number each time, that corresponds with our build process.</p>

<p>First, go get the SVN revision labeller and follow the instructions: <a href="http://code.google.com/p/svnrevisionlabeller/">http://code.google.com/p/svnrevisionlabeller/</a></p>

<p>This will automatically write the revision number in the .state file associated with your CruiseControl project. This file is usually stored at C:\Program Files\CruiseControl.NET\server[ProjectName].state</p>

<p>It’s just an XML file, so you can read the contents. Using a bit of Linq to XML, I am able to grab that data on the fly:</p>

<p>[code:c#]using System.Xml.Linq;<br />
using System.IO;</p>

<p>public string GetRevisionLabel()<br />
{<br />
 string result = String.Empty;<br />
 string stateFilePath = “C:\Program Files\CruiseControl.NET\server\MyProject.state”;<br />
 if (HttpContext.Current.Application[“BuildLabel”] != null)<br />
 {<br />
 result = (string)HttpContext.Current.Application[“BuildLabel”];<br />
 }<br />
 else if (File.Exists(stateFilePath))<br />
 {<br />
 XDocument stateFileRoot = XDocument.Load(stateFilePath);</p>

<p>var q = (from label in stateFileRoot.Descendants(“Label”)<br />
 select (string)label).SingleOrDefault();</p>

<p>if (q != null)<br />
 {<br />
 result = q.ToString();<br />
 HttpContext.Current.Application[“BuildLabel”] = result;<br />
 }<br />
 }<br />
 return result;<br />
}[/code]</p>

<p>Now display it wherever you like. In this case, you can see that I cache it for performance and easy access.</p>

<p>Security note: you might not want your web process reaching into the Program Files folder. I copy the .state files to App_Data as part of the build process, and query them there.</p>

<p>Hope this helps.</p>

<p>— —</p>

<p>Inspired by: <a href="http://stackoverflow.com/questions/913904/why-would-a-site-display-svn-version-and-what-are-the-advantages">http://stackoverflow.com/questions/913904/why-would-a-site-display-svn-version-and-what-are-the-advantages</a></p>
</div>
<footer class="post-footer">
  
</footer>
</article>
</main>
<footer class="footer">
  <span>&copy; 2017-2018 clipperhouse</span>
  <span>&middot;</span>
  <span>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a></span>
  <span>&middot;</span>
  <span>Designed by <a href="http://21beats.com/" target="_blank">21beats</a></span>
</footer>

</body>
</html>

